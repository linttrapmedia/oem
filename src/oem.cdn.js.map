{
  "version": 3,
  "sources": ["src/state/State.ts", "src/template/HTML.ts", "src/template/SVG.ts"],
  "sourcesContent": [
    "import { StateType } from '../types';\n\ntype Persistence = {\n  key: string;\n  storage: Storage;\n  overwrite?: boolean;\n};\n\nfunction getVal<T>(param: T, persistence?: Persistence): T {\n  if (!persistence) return param;\n  const storageParam: any = persistence.storage.getItem(persistence.key);\n  const parsedStorageParam = JSON.parse(storageParam);\n  const isStorageParamValid = parsedStorageParam !== null && parsedStorageParam !== undefined;\n  if ((persistence.overwrite ?? true) && isStorageParamValid) return parsedStorageParam;\n  if (!(persistence.overwrite ?? true) && isStorageParamValid) {\n    if (Array.isArray(param) && Array.isArray(parsedStorageParam)) {\n      return [...param, ...parsedStorageParam] as any;\n    } else if (typeof param === 'object' && typeof parsedStorageParam === 'object') {\n      return { ...param, ...parsedStorageParam };\n    }\n  }\n  return param;\n}\n\nexport function State<T>(param: T, persistence?: Persistence): StateType<T> {\n  let _val: T = getVal(param, persistence);\n  const _subs: ((param: T) => any)[] = [];\n  const $val = (): T => _val;\n\n  const _set = (atom: T) => {\n    _val = atom;\n    _subs.forEach((i) => i(atom));\n    if (persistence) persistence.storage.setItem(persistence.key, JSON.stringify(atom));\n  };\n  const $set = (atom: T) => () => _set(atom);\n\n  const reduce = (cb: (prev: T) => T) => _set(cb(_val));\n  const $reduce = (cb: (prev: T) => T) => () => _set(cb($val()));\n\n  const _sub = (cb: (val: T) => any) => {\n    if (!_subs.includes(cb)) _subs.push(cb);\n  };\n\n  const test = (regexOrVal: RegExp | T, checkFor: true | false = true) => {\n    const serialized_currentVal = JSON.stringify(_val);\n    if (regexOrVal instanceof RegExp) {\n      const result = regexOrVal.test(serialized_currentVal);\n      return checkFor ? result : !result;\n    } else {\n      const serialized_regex = JSON.stringify(regexOrVal);\n      const result = serialized_currentVal === serialized_regex;\n      return checkFor ? result : !result;\n    }\n  };\n\n  const $test =\n    (regexOrVal: RegExp | T, checkFor: true | false = true) =>\n    () => {\n      const serialized_currentVal = JSON.stringify(_val);\n      if (regexOrVal instanceof RegExp) {\n        const result = regexOrVal.test(serialized_currentVal);\n        return checkFor ? result : !result;\n      } else {\n        const serialized_regex = JSON.stringify(regexOrVal);\n        const result = serialized_currentVal === serialized_regex;\n        return checkFor ? result : !result;\n      }\n    };\n\n  const _unsub = (cb: (val: T) => any) => _subs.splice(_subs.indexOf(cb), 1);\n\n  return {\n    val: _val,\n    reduce: reduce,\n    set: _set,\n    sub: _sub,\n    test: test,\n    unsub: _unsub,\n    $val: $val,\n    $reduce: $reduce,\n    $set: $set,\n    $test: $test,\n  };\n}\n",
    "import { HtmlReturnType } from '../types';\n\nconst selectorMap = new Map<string, [any[], any]>();\n\nconst matchObserver = new MutationObserver((mutations) => {\n  mutations.forEach((mutation) => {\n    if (mutation.addedNodes.length > 0 && mutation.type === 'childList') {\n      for (const node of Array.from(mutation.addedNodes)) {\n        if (node instanceof Element) {\n          for (const [selector, [props, config]] of selectorMap.entries()) {\n            const els = Array.from(node.querySelectorAll(selector));\n            for (const el of els) HtmlTag(el as HTMLElement, props, config);\n          }\n        }\n      }\n    }\n  });\n});\nmatchObserver.observe(document, { attributes: true, childList: true, subtree: true });\n\nfunction AdoptElBySelector(selector: string, watch: boolean = true, config: any) {\n  return (...props: any[]) => {\n    // on mutation\n    if (watch) selectorMap.set(selector, [props, config]);\n    // onload\n    const els = Array.from(document.querySelectorAll(selector));\n    for (const el of els) HtmlTag(el as HTMLElement, props, config);\n  };\n}\n\nfunction AdoptElByInstance(el: HTMLElement, config: any) {\n  return (...props: any[]) => HtmlTag(el, props, config);\n}\n\nfunction CreateEl(tag: string, config: any) {\n  return (...props: any[]) => {\n    const ns = 'http://www.w3.org/1999/xhtml';\n    const el = document.createElementNS(ns, tag as string);\n    return HtmlTag(el, props, config);\n  };\n}\n\nfunction HtmlTag(el: HTMLElement, traits: any[] = [], config: any = {}) {\n  traits.forEach(([trait, ...args]) => config[trait](el, ...args));\n  function fn(...children: any[]) {\n    children.forEach((child) => {\n      if (child) el.append(child);\n    });\n    return el;\n  }\n  return fn;\n}\n\nexport function HTML<P extends Record<string, any>>(config?: P) {\n  return new Proxy(\n    {},\n    {\n      get: (_, prop) => {\n        if (prop === 'el') return (el: HTMLElement) => AdoptElByInstance(el, config);\n        if (prop === '$el') return (selector: string, watch: boolean) => AdoptElBySelector(selector, watch, config);\n        return CreateEl(prop as string, config);\n      },\n    },\n  ) as HtmlReturnType<P>;\n}\n",
    "import { SvgReturnType } from '../types';\n\nfunction SvgTag(el: SVGElement, traits: any[] = [], config: any = {}) {\n  traits.forEach(([trait, ...args]) => config[trait](el, ...args));\n  function fn(...children: any[]) {\n    children.forEach((child) => el.append(child));\n    return el;\n  }\n  return fn;\n}\n\nexport function SVG<P extends Record<string, any>>(config?: P) {\n  return new Proxy(\n    {},\n    {\n      get: (_, prop) => {\n        if (prop === 'el')\n          return (el: SVGElement) =>\n            (...props: any[]) =>\n              SvgTag(el, props, config);\n        return (...props: any[]) => {\n          const ns = 'http://www.w3.org/2000/svg';\n          const el = document.createElementNS(ns, prop as string);\n          return SvgTag(el, props, config);\n        };\n      },\n    },\n  ) as SvgReturnType<P>;\n}\n"
  ],
  "mappings": "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",
  "debugId": "F8C94982C115DF0C64756E2164756E21",
  "names": []
}