function S(e,t){if(!t)return e;let r=t.storage.getItem(t.key),n=JSON.parse(r),a=n!==null&&n!==void 0;if((t.overwrite??!0)&&a)return n;if(!(t.overwrite??!0)&&a){if(Array.isArray(e)&&Array.isArray(n))return[...e,...n];else if(typeof e==="object"&&typeof n==="object")return{...e,...n}}return e}function d(e,t){let r=S(e,t),n=[],a=()=>r,s=(o)=>{if(r=o,n.forEach((l)=>l(o)),t)t.storage.setItem(t.key,JSON.stringify(o))};return{reduce:(o)=>s(o(r)),set:s,sub:(o)=>{if(!n.includes(o))n.push(o)},test:(o,l=!0)=>{let T=JSON.stringify(r);if(o instanceof RegExp){let i=o.test(T);return l?i:!i}else if(typeof o==="function"&&o instanceof Function){let i=o(r);return l?i:!i}else{let i=JSON.stringify(o),m=T===i;return l?m:!m}},unsub:(o)=>n.splice(n.indexOf(o),1),val:a,$reduce:(o)=>()=>s(o(a())),$set:(o)=>()=>s(o),$test:(o,l=!0)=>()=>{let T=JSON.stringify(r);if(o instanceof RegExp){let i=o.test(T);return l?i:!i}else if(typeof o==="function"&&o instanceof Function){let i=o(r);return l?i:!i}else{let i=JSON.stringify(o),m=T===i;return l?m:!m}}}}function x(e,t){return(...r)=>{let a=document.createElementNS("http://www.w3.org/1999/xhtml",e);return P(a,r,t)}}function P(e,t=[],r={}){t.forEach(([a,...s])=>r[a](e,...s));function n(...a){return a.forEach((s)=>{if(s)e.append(s)}),e}return n}function p(e){return new Proxy({},{get:(t,r)=>x(r,e)})}function v(e,t,r,n=!0,...a){let s=()=>{let u=typeof n==="function"?n():n,c=typeof r==="function"?r():r,y=e.getAttribute(t)!==c;if(u&&y)e.setAttribute(t,String(c))};a.forEach((u)=>u.sub(s)),s()}function H(e,t,r=!0,...n){let a=()=>{let s=typeof r==="function"?r():r,u=typeof t==="function"?t():t,c=e.innerHTML!==u.outerHTML;if(s&&c)e.innerHTML="",e.appendChild(u)};n.forEach((s)=>s.sub(a)),a()}function L(e,t,r){e.addEventListener(t,r)}function M(e,t,r,n=!0,...a){let s=()=>{if(!(typeof n==="function"?n():n))return;t().forEach((c)=>{let y=r(c),f=e.querySelector(`[key="${y.getAttribute("key")}"]`),b=y.outerHTML!==f?.outerHTML;if(!f)return e.appendChild(y);if(f&&b)e.replaceChild(y,f)})};a.forEach((u)=>u.sub(s)),s()}var E=p({event:L,attr:v,html:H,map:M}),g=d([{id:1,title:"Learn TypeScript",completed:!0},{id:2,title:"Build a Todo App",completed:!1},{id:3,title:"Profit!",completed:!1}],{key:"todos",storage:localStorage}),A=(e,t,r)=>e.map((n)=>n.id===t?{...n,...r}:n),R=(e)=>E.li(["attr","id",e.id],["attr","key",e.id],["event","click",g.$reduce((t)=>A(t,e.id,{completed:!e.completed}))])(e.completed?"✓ ":"✗ ",e.title);document.addEventListener("DOMContentLoaded",()=>{document.getElementById("root").appendChild(E.ul(["map",g.val,R,!0,g])())});

//# debugId=75EA94ACB84C5B1364756E2164756E21
//# sourceMappingURL=index.js.map
