{
  "version": 3,
  "sources": ["../src/HTML.ts", "../src/State.ts", "../src/SVG.ts"],
  "sourcesContent": [
    "import { HtmlReturnType } from '@/types';\n\n// Global observer and registry\nconst traitCleanupMap = new WeakMap<HTMLElement, (() => void)[]>();\nconst observer = new MutationObserver((mutations) => {\n  for (const mutation of mutations) {\n    if (mutation.type === 'childList') {\n      mutation.removedNodes.forEach((node) => {\n        if (node instanceof HTMLElement && traitCleanupMap.has(node)) {\n          // Call all cleanup functions for this element\n          const funcs = traitCleanupMap.get(node)!;\n          funcs.forEach((fn) => fn());\n          traitCleanupMap.delete(node);\n        }\n      });\n    }\n  }\n});\n\n// Start observing once\nobserver.observe(document.body, { childList: true, subtree: true });\n\nfunction Trait<T extends any[]>(traitFn: (...args: T) => () => void) {\n  return (...traitProps: T) => {\n    const el: HTMLElement = traitProps[0] as HTMLElement;\n    const cleanupFunc = traitFn(...traitProps);\n\n    // Register cleanup function\n    const list = traitCleanupMap.get(el) || [];\n    list.push(cleanupFunc);\n    traitCleanupMap.set(el, list);\n\n    // Return a manual cleanup function\n    return () => {\n      const arr = traitCleanupMap.get(el);\n      if (arr) {\n        const idx = arr.indexOf(cleanupFunc);\n        if (idx !== -1) arr.splice(idx, 1);\n        if (arr.length === 0) traitCleanupMap.delete(el);\n      }\n      cleanupFunc();\n    };\n  };\n}\n\nfunction CreateEl(tag: string, config: any) {\n  return (...props: any[]) => {\n    const ns = 'http://www.w3.org/1999/xhtml';\n    const el = document.createElementNS(ns, tag as string);\n    return HtmlTag(el, props, config);\n  };\n}\n\nfunction HtmlTag(el: HTMLElement, traits: any[] = [], config: any = {}) {\n  traits.forEach(([trait, ...args]) => Trait(config[trait])(el, ...args));\n  function fn(...children: any[]) {\n    children.forEach((child) => {\n      if (child) el.append(child);\n    });\n    return el;\n  }\n  return fn;\n}\n\nexport function HTML<P extends Record<string, any>>(config?: P) {\n  return new Proxy(\n    {},\n    {\n      get: (_, prop) => CreateEl(prop as string, config),\n    },\n  ) as HtmlReturnType<P>;\n}\n",
    "import { StateType } from './types';\n\ntype Persistence = {\n  key: string;\n  storage: Storage;\n  overwrite?: boolean;\n};\n\nfunction getPersistedVal<T>(param: T, persistence?: Persistence): T {\n  if (!persistence) return param;\n  const storageParam: any = persistence.storage.getItem(persistence.key);\n  const parsedStorageParam = JSON.parse(storageParam);\n  const isStorageParamValid = parsedStorageParam !== null && parsedStorageParam !== undefined;\n  if ((persistence.overwrite ?? true) && isStorageParamValid) return parsedStorageParam;\n  if (!(persistence.overwrite ?? true) && isStorageParamValid) {\n    if (Array.isArray(param) && Array.isArray(parsedStorageParam)) {\n      return [...param, ...parsedStorageParam] as any;\n    } else if (typeof param === 'object' && typeof parsedStorageParam === 'object') {\n      return { ...param, ...parsedStorageParam };\n    }\n  }\n  return param;\n}\n\nexport function State<T>(param: T, persistence?: Persistence): StateType<T> {\n  let _val: T = getPersistedVal(param, persistence);\n  const _subs: Set<(param: T) => any> = new Set();\n  const val = (): T => _val;\n\n  const _set = (atom: T) => {\n    _val = atom;\n    _subs.forEach((i) => i(atom));\n    if (persistence) persistence.storage.setItem(persistence.key, JSON.stringify(atom));\n  };\n  const $set = (atom: T) => () => _set(atom);\n\n  const reduce = (cb: (prev: T) => T) => _set(cb(_val));\n  const $reduce = (cb: (prev: T) => T) => () => _set(cb(val()));\n\n  const _sub = (cb: (val: T) => any) => {\n    _subs.add(cb); // Set.add() automatically prevents duplicates of the same function reference\n    return () => _unsub(cb);\n  };\n\n  const test = (predicate: RegExp | T | ((atom: T) => boolean), truthCheck: true | false = true) => {\n    const serialized_currentVal = JSON.stringify(_val);\n    if (predicate instanceof RegExp) {\n      const result = predicate.test(serialized_currentVal);\n      return truthCheck ? result : !result;\n    } else if (typeof predicate === 'function' && predicate instanceof Function) {\n      const result = (predicate as (atom: T) => boolean)(_val);\n      return truthCheck ? result : !result;\n    } else {\n      const string_comparison = JSON.stringify(predicate);\n      const result = serialized_currentVal === string_comparison;\n      return truthCheck ? result : !result;\n    }\n  };\n\n  const $test =\n    (predicate: RegExp | T | ((atom: T) => boolean), truthCheck: true | false = true) =>\n    () => {\n      const serialized_currentVal = JSON.stringify(_val);\n      if (predicate instanceof RegExp) {\n        const result = predicate.test(serialized_currentVal);\n        return truthCheck ? result : !result;\n      } else if (typeof predicate === 'function' && predicate instanceof Function) {\n        const result = (predicate as (atom: T) => boolean)(_val);\n        return truthCheck ? result : !result;\n      } else {\n        const string_comparison = JSON.stringify(predicate);\n        const result = serialized_currentVal === string_comparison;\n        return truthCheck ? result : !result;\n      }\n    };\n\n  const _unsub = (cb: (val: T) => any) => {\n    _subs.delete(cb);\n  };\n  return {\n    reduce: reduce,\n    set: _set,\n    sub: _sub,\n    test: test,\n    unsub: _unsub,\n    val: val,\n    $reduce: $reduce,\n    $set: $set,\n    $test: $test,\n    _subs,\n  };\n}\n",
    "import { SvgReturnType } from '@/types';\n\nfunction SvgTag(el: SVGElement, traits: any[] = [], config: any = {}) {\n  traits.forEach(([trait, ...args]) => config[trait](el, ...args));\n  function fn(...children: any[]) {\n    children.forEach((child) => el.append(child));\n    return el;\n  }\n  return fn;\n}\n\nexport function SVG<P extends Record<string, any>>(config?: P) {\n  return new Proxy(\n    {},\n    {\n      get: (_, prop) => {\n        if (prop === 'el')\n          return (el: SVGElement) =>\n            (...props: any[]) =>\n              SvgTag(el, props, config);\n        return (...props: any[]) => {\n          const ns = 'http://www.w3.org/2000/svg';\n          const el = document.createElementNS(ns, prop as string);\n          return SvgTag(el, props, config);\n        };\n      },\n    },\n  ) as SvgReturnType<P>;\n}\n"
  ],
  "mappings": "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",
  "debugId": "3C5818E005E15B6764756E2164756E21",
  "names": []
}